/*! BingMapsFactory - v0.0.1 - 2013-06-12
* https://github.com/dannyrscott/BingMapFactory
* Copyright (c) 2013 Danny Scott; Licensed MIT */
(function(t){"use strict";var e,n=function(t){return Array.prototype.slice.call(arguments,1).forEach(function(e){if(e)for(var n in e)t[n]=e[n]}),t},o=[],i={credentials:"",zoom:17},s=function(o,s){if(!t.Microsoft||!t.Microsoft.Maps)throw"Microsoft Maps not loaded :(";e=Microsoft.Maps,s=s||{},this.opts=n(i,s),this.opts.credentials=this.opts.apiKey;var r=this.opts.center;this.opts.center=new e.Location(r.lat,r.lng),this.div=o||[]};s.prototype.load=function(){return this.map=new e.Map(this.div,this.opts),this},s.prototype.bind=function(t,i,s){var r={throttled:!0,delay:3e3};return r=n(r,s),i&&t?(r.eventName=r.eventName||t,o[r.eventName]=r.throttled?e.Events.addThrottledHandler(this.map,t,i,r.delay):e.Events.addHandler(this.map,t,i),this):this},s.prototype.unbind=function(t){return t?(o[t]&&e.Events.removeHandler(o[t]),this):this},s.prototype.addPin=function(t){var o={};o=n(o,t);var i=new e.Pushpin(new e.Location(o.lat,o.lng),o);return this.map.entities.push(i),this},t.BingMap=s})("object"==typeof exports&&exports||this);